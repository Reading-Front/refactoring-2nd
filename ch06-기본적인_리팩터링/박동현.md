# 기본적인 리팩토링

가장 많이 사용하는 것은 **함수 추출하기** **뱐수 추출하기**
이 두 리팩터링을 반대로하는 **함수 인라인하기**, **변수 인라인하기** 도 많이씀

- 함수는 한 화면을 넘어가면 안된다.
- 한 번만 쓰이는 코드는 인라인으로, 두 번 이상 사용될 코드는 함수로

### 목적과 구현을 분리하는 방식으로 구현하는것이 이상적

코드를 보고 무슨일을 하는지 한참 거린다면, 그 부분을 함수로 추출하여 '무슨 일'에 걸맞는 이름을 짓는다.

### 함수 호춞이 많아지는걸 고려하지 말자

이전에는 최적화, map보다 for문이 더 빠르다 이런것들이 많았지만, 요즘 컴파일러 성능이 향상되어 오히려 함수로 만들어 캐시로 쓰는것이 용이

## 리팩토링 절차

- 함수를 새로 만들고 목적을 잘 드러내는 이름을 붙인다.(어떻게가 아닌 무엇을? 하는지가 드러나야함)
- 추출할 코드를 원본 함수에서 복사하여 새 함수에 붙여 넣는다.
- 추출한 코드 중 원본 함수의 지역 변수를 참조하거나 추출한 함수의 유효범위를 벗어나는 변수가 없는지 검사한다.
  - 인수로 전달하면 유용
  - 변수가 너무 많으면, 임시 변수를 질의 함수로 만들거나, 변수쪼개기를 진행
- 변수를 다 처리했다면 컴파일 한다.(오류 확인)
- 원본 함수애서 추출할 코드 부분을 새로 만든 함수를 호출하는 문장으로 바꾼다.
- 테스트한다
- 다른 코드에 방금 추출한 것과 똑같거나 없는지 살핀다. 있따면 방금 추출한 새 함수를 호출하도록 바꿀지 검토한다.

## 알아두면 좋음

### 매개변수 객체 만들기

```typescript
//bad
function amountInvoiced(startDate, endDate) {...}
function amountReceived(startDate, endDate) {...}
function amountOverdue(startDate, endDate) {٠..}

//god
function amount Invoiced(aDateRange) {٠..}
function amountReceived(aDateRange) { . . .}
function amountOverdue(aDateRange) {...}
```

- 적당한 구조가 마련되어있지 않으면 새로 만든다
- 테스트 한다
- 함수 선언 바꾸기로 새 데이터 구조를 매개변수로 추가한다.
- 테스트한다
- 함수 호출 시 새로운 데이터 구조를 인스턴스를 넘기도록 수정한다.
- 기존 매개변수를 사용하던 코드를 새 데이터 구조의 원소를 사용하도록 바꾼다.
- 다 바꿨다면 기존 매개변수를 제거하고 테스트한다.
